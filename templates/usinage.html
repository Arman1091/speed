{% extends 'base.html' %}


{% block contenue %}

<div id="usinage_container" class="container " >
    <div class="row mt-5">
        <div class="col-md-6">
            <div>
                <!-- <h3>Matiere: <strong id="mt">{{matiere}}</strong>
                    <p id="mt_name">{{name}}</p>
                    </h1> -->
                <label for="matiere_select"><strong>Choisissez la matiere</strong></label>
                <select id="matiere_select" class="form-select form-select-lg mb-3"
                    aria-label=".form-select-lg example">
                    <!-- <option selected>Select le matiere</option> -->
                    {% for item in matieres %}
                    <option value='{{ item.id}}'>{{ item.name}}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="type_matiere"><strong>Choisissez le type</strong></label>
                <select id="type_matiere" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example">
                    <!-- <option selected>Select le matiere</option> -->
                    {% for item in types_matiers %}
                    <option value='{{ item.id}}'>{{ item.name}}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mt-5">
                <label for="epp"><strong>L'épaisseur de la matiere</strong></label>
                <select id="epp" class="form-select mt-1" aria-label="Default select example" style="width: 60%;">

                    {% for item in epaisseurs %}

                    <option value='{{ item.id}}'>{{ item.value}}</option>
                    {% endfor %}


                </select>
                <label for="type_usinage"><strong>Type d'usinage</strong></label>
                <select id="type_usinage" class="form-select mt-1" aria-label="Default select example"
                    style="width: 60%;">

                    {% for item in types_usinage %}

                    <option value='{{ item.id}}'>{{ item.name}}</option>
                    {% endfor %}


                </select>
            </div>
            <!-- <h3>Remplissez les chambs</h3> -->

            <!-- <div class="accordion" id="accordionExample">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                Accordion Item #2
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                            data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <strong>This is the second item's accordion body.</strong> It is hidden by default,
                                until the collapse plugin adds the appropriate classes that we use to style each
                                element. These classes control the overall appearance, as well as the showing and
                                hiding via CSS transitions. You can modify any of this with custom CSS or overriding
                                our default variables. It's also worth noting that just about any HTML can go within
                                the <code>.accordion-body</code>, though the transition does limit overflow.
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->

            <!-- HTML -->
            <div class="row mt-4">
                <div class="col-4">
                    <button id="file_btn" type="button" class=" case_btn btn  active-case border  border-secondary  "
                        style="padding-left: 8px;padding-right: 8px" onclick="upload_btn_active()"><i
                            class="bi bi-folder fs-1"></i>
                        <p>Télécharger</p>
                    </button>

                </div>
                <div class="col-4">
                    <button id="text_btn" type="button" class="case_btn btn  border  border-secondary  "
                        style="padding-left: 20px;padding-right: 20px" onclick="text_btn_active()"><i
                            class="bi bi-fonts fs-1"></i>
                        <p>Text</p>
                    </button>

                </div>


            </div>
            <div id="drop-area" class="mt-4">
                <h3 class="drop-text">Glissez et déposez un fichier DXF ici</h3>
                <input type="file" id="fileInput" accept=".dxf" />
                <div id="result-container"></div>
            </div>
            <div class="counter-container mt-4">
                <label class="mt-3" for="qte"><strong>Qte</strong></label>
                <button class="btn_counter" id="decrement">-</button>
                <!-- <span id="counter">1</span> -->
                <input id="qte" value=1 min="1">
                <button class="btn_counter" id="increment">+</button>
            </div>
            <!-- <div>
                <label class="mt-3" for="qte"><strong>Qte</strong></label>
                <input id="qte" value=1 min="1">
            </div> -->
            <div id="text-section" class="mt-3" style="display: none;">
                <form class="mt-4" action="/generate_dxf" method="post">
                    <!-- <fieldset disabled> -->
                    <label class="form-label" for="text_input">Saisissez le texte:</label>
                    <input id="text_input"class="form-control" type="text" name="text" required>
                    <label for="font" class="form-label">Select a font:</label>
                    <select class="form-select" id="fontSelect" name="font" required>
                        <option value="Arial">Arial</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Verdana">Verdana</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Comic Sans MS">Comic Sans MS</option>
                        <option value="Impact">Impact</option>
                        <option value="Lucida Console">Lucida Console</option>
                        <option value="Trebuchet MS">Trebuchet MS</option>
                        <option value="Palatino Linotype">Palatino Linotype</option>
                        <option value="Tahoma">Tahoma</option>
                        <option value="Franklin Gothic Medium">Franklin Gothic Medium</option>
                        <option value="Garamond">Garamond</option>
                        <option value="Copperplate">Copperplate</option>
                        <option value="Book Antiqua">Book Antiqua</option>
                        <option value="Arial Black">Arial Black</option>
                        <option value="Century Gothic">Century Gothic</option>
                        <option value="Candara">Candara</option>
                        <option value="Californian FB">Californian FB</option>
                        <option value="Constantia">Constantia</option>
                        <option value="Corbel">Corbel</option>
                        <option value="Ebrima">Ebrima</option>
                        <option value="Gabriola">Gabriola</option>
                        <option value="Javanese Text">Javanese Text</option>
                        <option value="Leelawadee UI">Leelawadee UI</option>
                        <option value="Microsoft JhengHei">Microsoft JhengHei</option>
                        <option value="MS Gothic">MS Gothic</option>
                        <option value="MV Boli">MV Boli</option>
                        <option value="Nirmala UI">Nirmala UI</option>
                        <option value="Segoe Print">Segoe Print</option>
                        <option value="Courier">Courier</option>
                        <option value="Brush Script MT">Brush Script MT</option>
                        <option value="OCR A Std">OCR A Std</option>
                        <option value="Rockwell">Rockwell</option>
                        <option value="Tw Cen MT">Tw Cen MT</option>
                        <option value="Century Schoolbook">Century Schoolbook</option>
                        <option value="Monotype Corsiva">Monotype Corsiva</option>
                        <option value="Bodoni MT">Bodoni MT</option>
                        <option value="Freestyle Script">Freestyle Script</option>
                        <option value="Papyrus">Papyrus</option>
                        <!-- Add more font options as needed -->
                    </select>

                    <!-- <label class="form-label" for="width">Text width:</label>
                    <input class="form-control" type="number" name="width" required> -->

                    <label class="form-label" for="height">Text height:</label>
                    <input class="form-control" type="number" name="height" required>

                    <!-- <button type="submit">Generate DXF</button> -->
                    <!-- </fieldset> -->
                </form>
            </div>
            <div  id="total_prix_detailles"class=" mt-5 justify-content-between align-items-center">
                <div class="bg-light">
                    <p><strong>Total prix:</strong></p>

                </div>
                <div class="bg-light">
                    <p>HT</p>

                    <h6> <strong id="prix_lin_ht">0</strong>€</h6>

                </div>
                <div class="col-3 bg-light">
                    <p>TTC</p>

                    <h6> <strong id="prix_lin_ttc">0</strong>€</h6>

                </div>
            </div>
            <div id="prix_detailles" class="row   mt-3">
               
                <div class="accordion" id="accordionExample" >
                    <div class="accordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                    La structure de prix
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                                data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-4">
                                            <p>Prix matériel</p>
                                        </div>
                                        <div class="col-4">
                                            <h6><strong id="prix_mat_ht">0€ </strong>&nbsp;HT</h6>
                                        </div>
                                        <div class="col-4">
                                            <h6><strong id="prix_mat_ttc">0€ </strong>&nbsp; TTC</h6>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-4">
                                            <p>Frais de découpe</p>
                                        </div>
                                        <div class="col-4">
                                            <h6><strong id="frais_decoup_ht"> </strong>€&nbsp;HT</h6>
                                        </div>
                                        <div class="col-4">
                                            <h6><strong id="frais_decoup_ttc"></strong>€&nbsp;TTC</h6>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-4">
                                            <p>Supplément de forme</p>
                                        </div>
                                        <div class="col-4">
                                            <h6><strong>Gratuit </strong></h6>
                                        </div>
                                        <div class="col-4">
                                            <h6><strong>Gratuit </strong></h6>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-4">
                                            <p><strong>Qte</strong></p>
                                        </div>
                                        <div class="col-4">
                                            <h6><strong id="qte_structure">1 </strong></h6>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion " id="acardion_format_pro" >
                    <div class="accordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapsePro" aria-expanded="false" aria-controls="collapsePro">
                                    Devis professionnel
                                </button>
                            </h2>
                            <div id="collapsePro" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                                data-bs-parent="#acardion_format_pro">
                                <div class="accordion-body">
                                    <div class="mb-3">
                                        <select id="cients_devis_pro" class="form-select custom-select" aria-label="Default select example" style="width: 60%;">
                                            <option value=-1 selected>Sélectionnez une client</option> 
                                            {% for item in clients %}
                    
                                            <option value='{{ item[1].id}}'>{{ item[2].name}}</option>
                                            {% endfor %}
                    
                                        </select>
                                    </div>
                                    <div class="mt-2">
                                        <!-- {{ url_for('static', filename= 'files/fact.pdf') }} -->
                                        <span id="tcrg_span" confirm onclick="telecharger_pdf('{{user.username}}')">Télécharger le devis <img
                                                src="{{ url_for('static', filename= 'img/logo/icon_pdf.jpg') }}" alt="Logo de pdf"
                                                style="width: 35px;" />
                                        </span>
                        
                        
                                    </div>
    
                     
                             
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-3 d-flex justify-content-center align-items-center">
                    <button  id="form_envoyer_usinage_btn"class=" btn btn-primary btn-block bg-success " onclick="ouvrir_form_envoi()">Envoyer usinage</button>
                </div>
                <!-- <div class="mt-4">
                    <button class=" bg-primary">Telecharger le devis</button>
                </div> -->
            </div>
        </div>


        <div id="visualisation_div"class="col-md-6">
            
            <iframe class="img_usinage mt-5" src="{{ url_for('static', filename= 'img/usinage/matiers/Pvc.jpg') }}"
                style="height: 55vh;width: 30%;margin-left: 5%; position: fixed;" ></iframe>
          
        </div>



        <div id="envoi_div" class="container">

            <div class="mb-3">
                <label for="dateInput" class="form-label">Date de livraison:</label>
                <input type="date" class="form-control" id="dateInput" name="date">
            </div>
            <div class="mb-3">
                <select id="client_select" class="form-select custom-select" aria-label="Default select example">
                    <!-- <option selected>Select une slient</option> -->
                    {% for item in clients %}

                    <option value='{{ item[1].id}}'>{{ item[2].name}}</option>
                    {% endfor %}

                </select>
            </div>
            <div class="mb-3">
                <label for="descriptionInput" class="form-label">Description:</label>
                <input type="text" class="form-control" id="descriptionInput" name="description">
            </div>
            <div class="d-flex justify-content-center">
                <button type="submit" class="btn btn-primary " style="background-color: rgb(110, 191, 63);"
                    onclick="envoyer_command()">Envoyer</button>
                <button type="submit" class="btn btn-primary " onclick="fermer_envoi()">Fermer</button>
            </div>


        </div>
    </div>
    
</div>
{% endblock %}
